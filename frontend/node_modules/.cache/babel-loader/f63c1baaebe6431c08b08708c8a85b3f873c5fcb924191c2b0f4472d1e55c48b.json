{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hasan Memi\\u015F\\\\Desktop\\\\DuyguAI_Yeni\\\\frontend\\\\src\\\\EmotionInput.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState } from 'react';\nimport { BACKEND_URL } from './config';\nimport './styles/EmotionInput.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function EmotionInput({\n  result,\n  setResult\n}) {\n  _s();\n  var _result$recommended_m;\n  const videoRef = useRef(null);\n  const [text, setText] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n\n  // Client-side ses kaydı (5s)\n  const startRecording = () => {\n    setRecording(true);\n    setTimeout(() => setRecording(false), 5000);\n  };\n  const captureAndAnalyze = async () => {\n    setLoading(true);\n    let base64Image = null;\n\n    // Yüz modu için\n    if (videoRef.current && videoRef.current.srcObject) {\n      const video = videoRef.current;\n      const canvas = document.createElement('canvas');\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n      base64Image = canvas.toDataURL('image/jpeg').split(',')[1];\n    }\n    try {\n      const payload = {\n        text: text || null,\n        face: base64Image,\n        use_audio: recording\n      };\n      const res = await fetch(`${BACKEND_URL}/api/analyze`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n      });\n      const data = await res.json();\n      setResult(data);\n    } catch (err) {\n      console.error(err);\n      alert('Sunucuya bağlanılamadı.');\n    }\n    setLoading(false);\n  };\n  const startCamera = () => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(stream => {\n      videoRef.current.srcObject = stream;\n    }).catch(() => alert('Kameraya erişilemedi.'));\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-modes\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mode\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Metin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: \"Metni buraya girin...\",\n          value: text,\n          onChange: e => setText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mode\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Y\\xFCz\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startCamera,\n          children: \"Kameray\\u0131 A\\xE7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          autoPlay: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mode\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Ses\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"record\",\n          onClick: startRecording,\n          disabled: recording,\n          children: recording ? 'Kaydediliyor…' : 'Ses Kaydı (5s)'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"analyze-button\",\n      onClick: captureAndAnalyze,\n      disabled: loading,\n      children: loading ? 'Analiz Ediliyor…' : 'Analiz Et'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), (result === null || result === void 0 ? void 0 : (_result$recommended_m = result.recommended_music) === null || _result$recommended_m === void 0 ? void 0 : _result$recommended_m.length) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-grid\",\n      children: result.recommended_music.map(id => /*#__PURE__*/_jsxDEV(\"iframe\", {\n        src: `https://www.youtube.com/embed/${id}?autoplay=1`,\n        allow: \"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\",\n        allowFullScreen: true,\n        title: id\n      }, id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}\n_s(EmotionInput, \"Aw3SlWUxZGTnB2mO9qzop+3+yjw=\");\n_c = EmotionInput;\nvar _c;\n$RefreshReg$(_c, \"EmotionInput\");","map":{"version":3,"names":["React","useRef","useState","BACKEND_URL","jsxDEV","_jsxDEV","Fragment","_Fragment","EmotionInput","result","setResult","_s","_result$recommended_m","videoRef","text","setText","loading","setLoading","recording","setRecording","startRecording","setTimeout","captureAndAnalyze","base64Image","current","srcObject","video","canvas","document","createElement","width","videoWidth","height","videoHeight","getContext","drawImage","toDataURL","split","payload","face","use_audio","res","fetch","method","headers","body","JSON","stringify","data","json","err","console","error","alert","startCamera","navigator","mediaDevices","getUserMedia","then","stream","catch","children","className","fileName","_jsxFileName","lineNumber","columnNumber","placeholder","value","onChange","e","target","onClick","ref","autoPlay","disabled","recommended_music","length","map","id","src","allow","allowFullScreen","title","_c","$RefreshReg$"],"sources":["C:/Users/Hasan Memiş/Desktop/DuyguAI_Yeni/frontend/src/EmotionInput.js"],"sourcesContent":["import React, { useRef, useState } from 'react';\r\nimport { BACKEND_URL } from './config';\r\nimport './styles/EmotionInput.css';\r\n\r\nexport default function EmotionInput({ result, setResult }) {\r\n  const videoRef = useRef(null);\r\n  const [text, setText] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [recording, setRecording] = useState(false);\r\n\r\n  // Client-side ses kaydı (5s)\r\n  const startRecording = () => {\r\n    setRecording(true);\r\n    setTimeout(() => setRecording(false), 5000);\r\n  };\r\n\r\n  const captureAndAnalyze = async () => {\r\n    setLoading(true);\r\n    let base64Image = null;\r\n\r\n    // Yüz modu için\r\n    if (videoRef.current && videoRef.current.srcObject) {\r\n      const video = videoRef.current;\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = video.videoWidth;\r\n      canvas.height = video.videoHeight;\r\n      canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\r\n      base64Image = canvas.toDataURL('image/jpeg').split(',')[1];\r\n    }\r\n\r\n    try {\r\n      const payload = {\r\n        text: text || null,\r\n        face: base64Image,\r\n        use_audio: recording\r\n      };\r\n\r\n      const res = await fetch(`${BACKEND_URL}/api/analyze`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      const data = await res.json();\r\n      setResult(data);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Sunucuya bağlanılamadı.');\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  const startCamera = () => {\r\n    navigator.mediaDevices.getUserMedia({ video: true })\r\n      .then(stream => { videoRef.current.srcObject = stream; })\r\n      .catch(() => alert('Kameraya erişilemedi.'));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"input-modes\">\r\n        {/* Metin */}\r\n        <div className=\"mode\">\r\n          <h4>Metin</h4>\r\n          <textarea\r\n            placeholder=\"Metni buraya girin...\"\r\n            value={text}\r\n            onChange={e => setText(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        {/* Yüz */}\r\n        <div className=\"mode\">\r\n          <h4>Yüz</h4>\r\n          <button onClick={startCamera}>Kamerayı Aç</button>\r\n          <video ref={videoRef} autoPlay />\r\n        </div>\r\n\r\n        {/* Ses */}\r\n        <div className=\"mode\">\r\n          <h4>Ses</h4>\r\n          <button\r\n            className=\"record\"\r\n            onClick={startRecording}\r\n            disabled={recording}\r\n          >\r\n            {recording ? 'Kaydediliyor…' : 'Ses Kaydı (5s)'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        className=\"analyze-button\"\r\n        onClick={captureAndAnalyze}\r\n        disabled={loading}\r\n      >\r\n        {loading ? 'Analiz Ediliyor…' : 'Analiz Et'}\r\n      </button>\r\n\r\n      {/* YouTube önerileri */}\r\n      {result?.recommended_music?.length > 0 && (\r\n        <div className=\"video-grid\">\r\n          {result.recommended_music.map(id => (\r\n            <iframe\r\n              key={id}\r\n              src={`https://www.youtube.com/embed/${id}?autoplay=1`}\r\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n              allowFullScreen\r\n              title={id}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}